/*! sun-dog 2016-02-05 */
var app=angular.module("sunDog",["ngRoute"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/landing.html",controller:"landingPage"}).when("/signup",{templateUrl:"views/signup.html",controller:"signup",controllerAs:"signup"}).when("/account",{templateUrl:"views/account.html",controller:"account"}),b.html5Mode(!0)}]),app.controller("landingPage",["$scope","zipCodeService",function(a,b){a.zipCodeKeyPress=b.keyPress,a.zipCode=b.data}]),app.controller("signup",["signUpService",function(a){this.data=a.data,this.signUp=a.signUp,this.next=a.next,this.agencyAgreement=a.agencyAgreement,this.dataPrivacyAgreement=a.dataPrivacyAgreement}]),app.controller("account",["$scope",function(a){}]),app.factory("zipCodeService",["$http","$location",function(a,b){var c={},d=function(){5==c.input.length&&a.post("/zipCode",c).then(function(a){c.response=!0,c.utility=a.data.name,c.isNSP=a.data.isNSP,c.isNSP&&b.path("/signup")})};return{keyPress:d,data:c}}]),app.factory("signUpService",["$http","$location",function(a,b){var c={status:"Join Sun Dog and sign up for solar today!",signUpCompleted:!1,nextCompleted:!1,agencyAgreementCompleted:!1,dataAgreementCompleted:!1},d=function(){c.signUpError="",console.log("email address is",c.emailAddress),validatePassword(c.password)&&validateEmail(c.emailAddress)?(c.signUpCompleted=!0,console.log("signed up!"),a.post("signUp/register",c).then(function(a){console.log("response is ",a),200==a.status&&(c._id=a.data._id,c.status="Registration successful")})):(validatePassword(c.password)||(c.signUpError="Password invalid. "),validateEmail(c.emailAddress)||(c.signUpError+="Email invalid."),console.log("nope"))},e=function(){a.post("/signUp/account",c).then(function(a){200==a.status&&(c.status="You're all set")}),c.nextCompleted=!0,console.log("next!")},f=function(){c.agencyAgreed?a.post("/signUp/agency",c).then(function(a){200==a.status&&(console.log(a),c.status="You're all set",c.agencyAgreementCompleted=!0,console.log("signed agency!"))}):c.status="Please check the box to continue"},g=function(){console.log("data.dataAgreed is ",c.dataAgreed),c.dataAgreed?a.post("/signUp/data",c).then(function(a){200==a.status&&(console.log(a),c.status="You're all set",c.dataAgreementCompleted=!0,console.log("signed data privacy!"))}):c.status="Please check the box to continue"};return{signUp:d,next:e,agencyAgreement:f,dataPrivacyAgreement:g,data:c}}]);var validatePassword=function(a){return a.length>=7?!0:!1},validateEmail=function(a){var b=/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;return a.match(b)?!0:!1};